apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

namespace: waddlebot

# Common labels applied to all resources
commonLabels:
  app.kubernetes.io/part-of: waddlebot
  app.kubernetes.io/managed-by: kustomize

resources:
  # Namespace
  - namespace.yaml

  # Configuration
  - configmap.yaml
  - secrets.yaml

  # Infrastructure
  - infrastructure/postgres.yaml
  - infrastructure/redis.yaml
  - infrastructure/minio.yaml
  - infrastructure/qdrant.yaml
  - infrastructure/ollama.yaml

  # Core Modules
  - core/router.yaml
  - core/hub.yaml
  - core/identity.yaml
  - core/labels.yaml
  - core/browser-source.yaml
  - core/reputation.yaml
  - core/community.yaml
  - core/ai-researcher.yaml

  # Collector Modules
  - collectors/twitch.yaml
  - collectors/discord.yaml
  - collectors/slack.yaml
  - collectors/youtube-live.yaml
  - collectors/kick.yaml

  # Interactive Modules
  - interactive/ai.yaml
  - interactive/alias.yaml
  - interactive/shoutout.yaml
  - interactive/inventory.yaml
  - interactive/calendar.yaml
  - interactive/memories.yaml
  - interactive/youtube-music.yaml
  - interactive/spotify.yaml
  - interactive/loyalty.yaml

  # Pushing Action Modules
  - pushing/discord-action.yaml
  - pushing/slack-action.yaml
  - pushing/twitch-action.yaml
  - pushing/youtube-action.yaml

  # Ingress
  - ingress.yaml

# ConfigMap generator for environment-specific overrides
# Disabled due to conflict with configmap.yaml in resources list
# configMapGenerator:
#   - name: waddlebot-config
#     behavior: merge
#     literals:
#       - LOG_LEVEL=INFO
#       - RELEASE_MODE=false

# Images to use (can be overridden with kustomize edit set image)
images:
  - name: localhost:32000/waddlebot/router_module_flask
    newTag: latest
  - name: localhost:32000/waddlebot/hub_module
    newTag: latest
