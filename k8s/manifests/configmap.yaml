apiVersion: v1
kind: ConfigMap
metadata:
  name: waddlebot-config
  namespace: waddlebot
  labels:
    app.kubernetes.io/name: waddlebot
    app.kubernetes.io/instance: waddlebot
    app.kubernetes.io/component: configuration
data:
  # Database Configuration
  # NOTE: DATABASE_URL is constructed in deployments using secretKeyRef for password
  # Router module uses component-based config (DATABASE_HOST, etc.)
  DATABASE_HOST: "infra-postgres"
  DATABASE_PORT: "5432"
  DATABASE_NAME: "waddlebot"
  DATABASE_USER: "waddlebot"
  DB_POOL_SIZE: "20"
  DB_MAX_OVERFLOW: "10"
  # Read replica for router load balancing
  READ_REPLICA_HOST: "infra-postgres-replica"
  READ_REPLICA_PORT: "5432"

  # Redis Configuration
  REDIS_HOST: "infra-redis"
  REDIS_PORT: "6379"
  REDIS_DB: "0"
  # Module-specific Redis key prefixes
  REDIS_KEY_PREFIX: "waddlebot:"

  # MinIO Configuration
  MINIO_ENDPOINT: "infra-minio:9000"
  MINIO_BUCKET: "waddlebot-assets"
  S3_STORAGE_ENABLED: "true"
  S3_BUCKET_NAME: "waddlebot-assets"
  S3_ENDPOINT_URL: "http://infra-minio:9000"

  # Qdrant Configuration
  QDRANT_HOST: "infra-qdrant"
  QDRANT_PORT: "6333"
  QDRANT_URL: "http://infra-qdrant:6333"
  MEM0_VECTOR_STORE: "qdrant"

  # Ollama Configuration
  OLLAMA_HOST: "ai-ollama"
  OLLAMA_PORT: "11434"
  OLLAMA_MODEL: "tinyllama"
  OLLAMA_USE_TLS: "false"
  AI_PROVIDER: "ollama"

  # Service URLs - Processing
  ROUTER_URL: "http://core-router:8000"
  ROUTER_API_URL: "http://core-router:8000"
  ROUTER_HOST: "core-router"
  ROUTER_PORT: "8000"

  # Service URLs - Core
  IDENTITY_API_URL: "http://core-identity:8050"
  LABELS_API_URL: "http://core-labels:8023"
  BROWSER_SOURCE_API_URL: "http://core-browser-source:8027"
  REPUTATION_API_URL: "http://core-reputation:8021"
  COMMUNITY_URL: "http://core-community:8020"

  # Service URLs - Action Interactive (matches docker-compose.yml ports)
  AI_INTERACTION_URL: "http://interactive-ai:8005"
  ALIAS_INTERACTION_URL: "http://interactive-alias:8010"
  SHOUTOUT_API_URL: "http://interactive-shoutout:8011"
  INVENTORY_API_URL: "http://interactive-inventory:8024"
  CALENDAR_API_URL: "http://interactive-calendar:8030"
  MEMORIES_API_URL: "http://interactive-memories:8031"
  YOUTUBE_MUSIC_URL: "http://interactive-youtube-music:8025"
  SPOTIFY_URL: "http://interactive-spotify:8026"
  LOYALTY_API_URL: "http://interactive-loyalty:8032"

  # Service URLs - Trigger Receivers (matches docker-compose.yml)
  TWITCH_RECEIVER_URL: "http://trigger-twitch:8002"
  DISCORD_RECEIVER_URL: "http://trigger-discord:8003"
  SLACK_RECEIVER_URL: "http://trigger-slack:8004"
  YOUTUBE_RECEIVER_URL: "http://trigger-youtube:8006"
  KICK_RECEIVER_URL: "http://trigger-kick:8007"

  # Service URLs - Admin
  HUB_URL: "http://hub-api:8060"
  HUB_API_URL: "http://hub-api:8060"
  HUB_HOST: "hub-api"
  HUB_PORT: "8060"

  # Application Configuration
  RELEASE_MODE: "false"
  LOG_LEVEL: "INFO"
  ENVIRONMENT: "development"
  DEBUG: "false"

  # Flask Configuration
  FLASK_ENV: "production"
  FLASK_DEBUG: "0"

  # Session Configuration
  SESSION_TYPE: "redis"
  PERMANENT_SESSION_LIFETIME: "86400"

  # Security Configuration
  CORS_ORIGINS: "*"
  ALLOWED_HOSTS: "*"

  # Rate Limiting
  RATELIMIT_ENABLED: "true"
  RATELIMIT_STORAGE_URL: "redis://redis-service:6379/1"

  # Worker Configuration
  THREAD_POOL_SIZE: "10"
  MAX_WORKERS: "20"

  # Logging Configuration
  LOG_DIR: "/var/log/waddlebotlog"
  LOG_MAX_BYTES: "10485760"
  LOG_BACKUP_COUNT: "5"

  # Platform Configuration
  TWITCH_CALLBACK_URL: "http://localhost:30080/api/twitch/callback"
  DISCORD_CALLBACK_URL: "http://localhost:30080/api/discord/callback"
  SLACK_CALLBACK_URL: "http://localhost:30080/api/slack/callback"
  SPOTIFY_CALLBACK_URL: "http://localhost:30080/api/spotify/callback"

  # License Server (disabled in development)
  LICENSE_SERVER_URL: "https://license.penguintech.io"
  LICENSE_CHECK_ENABLED: "false"
