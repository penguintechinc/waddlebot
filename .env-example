# WaddleBot Environment Variables
# Copy this file to .env and fill in the values
#
# Legend:
#   [REQUIRED] - Must be set for the module to function
#   [OPTIONAL] - Has a default value or can be omitted
#   Modules listed in (parentheses) indicate which modules use this variable

# =============================================================================
# GLOBAL - Database Configuration
# Used by: ALL modules
# =============================================================================
POSTGRES_USER=waddlebot                    # [REQUIRED] PostgreSQL username
POSTGRES_PASSWORD=waddlebot_password       # [REQUIRED] PostgreSQL password
POSTGRES_DB=waddlebot                      # [REQUIRED] PostgreSQL database name
DATABASE_URL=postgresql://waddlebot:waddlebot_password@db:5432/waddlebot  # [REQUIRED]

# =============================================================================
# GLOBAL - Redis Configuration
# Used by: router, discord, labels_core, browser_source_core
# =============================================================================
REDIS_URL=redis://localhost:6379/0         # [OPTIONAL] Full Redis URL
REDIS_HOST=redis                           # [OPTIONAL] Redis hostname (default: redis)
REDIS_PORT=6379                            # [OPTIONAL] Redis port (default: 6379)
REDIS_DB=0                                 # [OPTIONAL] Redis database number
REDIS_PASSWORD=                            # [OPTIONAL] Redis password if auth required

# Redis ACL Passwords (per-module authentication)
# These match the users defined in config/redis/users.acl
REDIS_ADMIN_PASSWORD=waddlebot_admin_dev          # [REQUIRED] Admin user password
REDIS_ROUTER_PASSWORD=waddlebot_router_dev        # [REQUIRED] Router module password
REDIS_HUB_PASSWORD=waddlebot_hub_dev              # [REQUIRED] Hub module password
REDIS_WORKFLOW_PASSWORD=waddlebot_workflow_dev    # [REQUIRED] Workflow module password
REDIS_AI_PASSWORD=waddlebot_ai_dev                # [REQUIRED] AI module password
REDIS_ANALYTICS_PASSWORD=waddlebot_analytics_dev  # [REQUIRED] Analytics module password
REDIS_SECURITY_PASSWORD=waddlebot_security_dev    # [REQUIRED] Security module password
REDIS_LOYALTY_PASSWORD=waddlebot_loyalty_dev      # [REQUIRED] Loyalty module password
REDIS_SPOTIFY_PASSWORD=waddlebot_spotify_dev      # [REQUIRED] Spotify module password
REDIS_YTMUSIC_PASSWORD=waddlebot_ytmusic_dev      # [REQUIRED] YouTube Music module password
REDIS_TWITCH_PASSWORD=waddlebot_twitch_dev        # [REQUIRED] Twitch module password
REDIS_DISCORD_PASSWORD=waddlebot_discord_dev      # [REQUIRED] Discord module password
REDIS_SLACK_PASSWORD=waddlebot_slack_dev          # [REQUIRED] Slack module password

# =============================================================================
# KONG API GATEWAY (config/kong/)
# Used by: ALL external API access via api.waddlebot.io
# =============================================================================
KONG_DATABASE=off                          # [REQUIRED] DB-less mode (default: off)
KONG_DECLARATIVE_CONFIG=/etc/kong/kong.yml # [REQUIRED] Path to declarative config
KONG_ADMIN_LISTEN=127.0.0.1:8001          # [OPTIONAL] Admin API listen address
KONG_PROXY_LISTEN=0.0.0.0:8000, 0.0.0.0:8443 ssl  # [OPTIONAL] Proxy listen addresses
KONG_SSL_CERT=/etc/kong/ssl/api.waddlebot.io.crt   # [OPTIONAL] SSL certificate path
KONG_SSL_CERT_KEY=/etc/kong/ssl/api.waddlebot.io.key  # [OPTIONAL] SSL key path
KONG_RATE_LIMIT_MINUTE=60                 # [OPTIONAL] Anonymous rate limit per minute
KONG_RATE_LIMIT_HOUR=1000                 # [OPTIONAL] Anonymous rate limit per hour
KONG_PROXY_ACCESS_LOG=/dev/stdout         # [OPTIONAL] Proxy access log location
KONG_ADMIN_ACCESS_LOG=/dev/stdout         # [OPTIONAL] Admin access log location
KONG_PROXY_ERROR_LOG=/dev/stderr          # [OPTIONAL] Proxy error log location
KONG_ADMIN_ERROR_LOG=/dev/stderr          # [OPTIONAL] Admin error log location

# =============================================================================
# GLOBAL - Core API URLs
# Used by: ALL trigger and action modules
# =============================================================================
CORE_API_URL=http://router:8000            # [REQUIRED] Base router API URL
ROUTER_API_URL=http://router:8000/api/v1/router  # [REQUIRED] Router events endpoint
HUB_API_URL=http://hub-module:8060         # [OPTIONAL] Hub module for activity tracking
SERVICE_API_KEY=                           # [OPTIONAL] Internal service API key for hub

# =============================================================================
# GLOBAL - Security & Logging
# Used by: ALL modules
# =============================================================================
SECRET_KEY=change-me-in-production         # [REQUIRED] Application secret key
LOG_LEVEL=INFO                             # [OPTIONAL] Logging level (DEBUG, INFO, WARN, ERROR)

# =============================================================================
# ROUTER MODULE (processing/router_module)
# =============================================================================
ROUTER_MAX_WORKERS=20                      # [OPTIONAL] ThreadPoolExecutor workers
ROUTER_MAX_CONCURRENT=100                  # [OPTIONAL] Max concurrent requests
ROUTER_ENTITY_CACHE_TTL=300                # [OPTIONAL] Entity-community cache TTL in seconds

# =============================================================================
# DISCORD MODULE (trigger/receiver/discord_module)
# Bot with slash commands, prefix commands, modals, buttons
# =============================================================================
DISCORD_BOT_TOKEN=                         # [REQUIRED] Discord bot token from Developer Portal
DISCORD_APPLICATION_ID=                    # [REQUIRED] Discord application/client ID
DISCORD_PUBLIC_KEY=                        # [OPTIONAL] For webhook verification (if using webhooks)
DISCORD_BOT_ENABLED=true                   # [OPTIONAL] Enable/disable Discord bot (default: true)

# =============================================================================
# SLACK MODULE (trigger/receiver/slack_module)
# Bot with slash commands (/waddlebot), prefix commands (!), modals, buttons
# =============================================================================
SLACK_BOT_TOKEN=xoxb-...                   # [REQUIRED] Slack Bot User OAuth Token
SLACK_SIGNING_SECRET=                      # [REQUIRED] Slack app signing secret for verification
SLACK_APP_TOKEN=xapp-...                   # [CONDITIONAL] Required for Socket Mode
USE_SOCKET_MODE=false                      # [OPTIONAL] Use Socket Mode vs HTTP (default: false)
SLACK_CLIENT_ID=                           # [OPTIONAL] For OAuth flows
SLACK_CLIENT_SECRET=                       # [OPTIONAL] For OAuth flows

# =============================================================================
# TWITCH MODULE (trigger/receiver/twitch_module)
# IRC bot with !prefix commands and EventSub webhooks
# =============================================================================
# Twitch API Credentials (for API calls)
TWITCH_CLIENT_ID=                          # [REQUIRED] Twitch application client ID
TWITCH_CLIENT_SECRET=                      # [REQUIRED] Twitch application client secret
TWITCH_ACCESS_TOKEN=                       # [OPTIONAL] App access token (auto-generated if missing)

# Twitch IRC Bot Configuration
TWITCH_BOT_TOKEN=oauth:...                 # [REQUIRED] OAuth token for IRC chat (get from twitchtokengenerator.com)
TWITCH_BOT_NICK=WaddleBot                  # [OPTIONAL] Bot username in chat (default: WaddleBot)
TWITCH_BOT_ENABLED=true                    # [OPTIONAL] Enable/disable IRC bot (default: true)

# Twitch EventSub Configuration
EVENTSUB_SECRET=                           # [REQUIRED] Secret for webhook signature verification
EVENTSUB_CALLBACK_URL=https://your-domain.com/eventsub/webhook  # [REQUIRED] Public webhook URL
EVENTSUB_ENABLED=true                      # [OPTIONAL] Enable/disable EventSub (default: true)

# Twitch Viewer Tracking
VIEWER_TRACKING_ENABLED=true               # [OPTIONAL] Track viewer activity (default: true)
VIEWER_POLL_INTERVAL=60                    # [OPTIONAL] Viewer poll interval in seconds
CHANNEL_REFRESH_INTERVAL=300               # [OPTIONAL] Channel list refresh interval

# =============================================================================
# AI INTERACTION MODULE (action/interactive/ai_interaction_module)
# Supports Ollama, OpenAI, and MCP providers
# =============================================================================
AI_PROVIDER=ollama                         # [REQUIRED] Provider: ollama, openai, or mcp
AI_MODEL=llama3.2                          # [REQUIRED] Model name to use

# Ollama Configuration
OLLAMA_HOST=http://ollama:11434            # [CONDITIONAL] Required if AI_PROVIDER=ollama
AI_HOST=http://ollama:11434                # [OPTIONAL] Alias for OLLAMA_HOST

# OpenAI Configuration
OPENAI_API_KEY=                            # [CONDITIONAL] Required if AI_PROVIDER=openai
OPENAI_MODEL=gpt-4o-mini                   # [OPTIONAL] OpenAI model (default: gpt-4o-mini)
OPENAI_BASE_URL=https://api.openai.com/v1  # [OPTIONAL] OpenAI API base URL

# MCP Configuration
MCP_SERVER_URL=http://mcp-server:8080      # [CONDITIONAL] Required if AI_PROVIDER=mcp
MCP_TIMEOUT=30                             # [OPTIONAL] MCP request timeout

# AI Behavior Settings
AI_TEMPERATURE=0.7                         # [OPTIONAL] Response creativity (0.0-1.0)
AI_MAX_TOKENS=500                          # [OPTIONAL] Max response tokens
SYSTEM_PROMPT=You are a helpful chatbot assistant.  # [OPTIONAL] Default system prompt
QUESTION_TRIGGERS=?                        # [OPTIONAL] Characters that trigger AI responses
RESPONSE_PREFIX=                           # [OPTIONAL] Prefix for AI responses
MAX_CONCURRENT_REQUESTS=10                 # [OPTIONAL] Max concurrent AI requests
REQUEST_TIMEOUT=30                         # [OPTIONAL] AI request timeout in seconds
ENABLE_CHAT_CONTEXT=true                   # [OPTIONAL] Include chat history context
CONTEXT_HISTORY_LIMIT=5                    # [OPTIONAL] Number of messages for context
RESPOND_TO_EVENTS=true                     # [OPTIONAL] AI responds to platform events
EVENT_RESPONSE_TYPES=subscription,follow,donation,cheer,raid,boost  # [OPTIONAL] Event types

# =============================================================================
# SHOUTOUT INTERACTION MODULE (action/interactive/shoutout_interaction_module)
# =============================================================================
# Uses TWITCH_CLIENT_ID, TWITCH_CLIENT_SECRET, TWITCH_ACCESS_TOKEN from above

# =============================================================================
# SPOTIFY INTERACTION MODULE (action/interactive/spotify_interaction_module)
# =============================================================================
SPOTIFY_CLIENT_ID=                         # [REQUIRED] Spotify application client ID
SPOTIFY_CLIENT_SECRET=                     # [REQUIRED] Spotify application client secret
SPOTIFY_REDIRECT_URI=http://localhost:8006/callback  # [REQUIRED] OAuth redirect URI

# =============================================================================
# YOUTUBE MUSIC INTERACTION MODULE (action/interactive/youtube_music_interaction_module)
# =============================================================================
YOUTUBE_API_KEY=                           # [REQUIRED] YouTube Data API key
YOUTUBE_OAUTH_CLIENT_ID=                   # [OPTIONAL] For user-authenticated requests
YOUTUBE_OAUTH_CLIENT_SECRET=               # [OPTIONAL] For user-authenticated requests

# =============================================================================
# LOYALTY INTERACTION MODULE (action/interactive/loyalty_interaction_module)
# Currency, giveaways, minigames, duels, and gear progression system
# =============================================================================
LOYALTY_API_URL=http://loyalty-interaction:8032  # [OPTIONAL] Loyalty module URL

# Loyalty Defaults
LOYALTY_CURRENCY_NAME=Points               # [OPTIONAL] Default currency name
LOYALTY_CURRENCY_SYMBOL=P                  # [OPTIONAL] Default currency symbol
LOYALTY_CURRENCY_EMOJI=ðŸª™                  # [OPTIONAL] Default currency emoji

# Gambling Settings
LOYALTY_MIN_BET=10                         # [OPTIONAL] Minimum gambling bet
LOYALTY_MAX_BET=10000                      # [OPTIONAL] Maximum gambling bet
LOYALTY_HOUSE_EDGE=0.05                    # [OPTIONAL] House edge (0.05 = 5%)

# Duel Settings
LOYALTY_DUEL_MIN_WAGER=10                  # [OPTIONAL] Minimum duel wager
LOYALTY_DUEL_MAX_WAGER=5000                # [OPTIONAL] Maximum duel wager
LOYALTY_DUEL_TIMEOUT=5                     # [OPTIONAL] Duel timeout in minutes

# =============================================================================
# BROWSER SOURCE CORE MODULE (core/browser_source_core_module)
# =============================================================================
WEBSOCKET_PORT=8052                        # [OPTIONAL] WebSocket server port
OVERLAY_BASE_URL=https://overlay.waddlebot.io  # [OPTIONAL] Base URL for overlay subdomain
OVERLAY_KEY_GRACE_PERIOD_MINUTES=5         # [OPTIONAL] Grace period for overlay key expiration

# =============================================================================
# IDENTITY CORE MODULE (core/identity_core_module)
# =============================================================================
IDENTITY_JWT_SECRET=change-me-in-production  # [REQUIRED] JWT signing secret
IDENTITY_TOKEN_EXPIRY=3600                 # [OPTIONAL] Token expiry in seconds

# =============================================================================
# HUB MODULE (admin/hub_module)
# =============================================================================
JWT_SECRET=change-me-in-production         # [REQUIRED] JWT signing secret for hub auth
JWT_EXPIRY=3600                            # [OPTIONAL] JWT expiry in seconds
ADMIN_EMAIL=admin@localhost                # [OPTIONAL] Default admin email
ADMIN_PASSWORD=admin                       # [OPTIONAL] Default admin password (change in prod!)

# Email/SMTP Configuration (for email verification)
SMTP_HOST=                                 # [OPTIONAL] SMTP server hostname
SMTP_PORT=587                              # [OPTIONAL] SMTP port
SMTP_USERNAME=                             # [OPTIONAL] SMTP username
SMTP_PASSWORD=                             # [OPTIONAL] SMTP password
SMTP_TLS=true                              # [OPTIONAL] Use TLS
FROM_EMAIL=noreply@waddlebot.com           # [OPTIONAL] From email address

# Signup Controls
DISABLE_SIGNUPS=false                      # [OPTIONAL] Disable new user signups
REQUIRE_EMAIL_VERIFICATION=false           # [OPTIONAL] Require email verification

# =============================================================================
# LABELS CORE MODULE (core/labels_core_module)
# =============================================================================
MAX_WORKERS=20                             # [OPTIONAL] ThreadPoolExecutor workers
CACHE_TTL=300                              # [OPTIONAL] Label cache TTL in seconds
BULK_OPERATION_SIZE=1000                   # [OPTIONAL] Max bulk operation size

# =============================================================================
# REPUTATION MODULE (core/reputation_module)
# FICO-style reputation scoring system (300-850 range, default 600)
# =============================================================================
REPUTATION_API_URL=http://reputation:8021  # [OPTIONAL] Reputation module URL
REPUTATION_ENABLED=true                    # [OPTIONAL] Enable/disable reputation tracking
WEIGHT_CACHE_TTL=300                       # [OPTIONAL] Weight config cache TTL in seconds

# Reputation score defaults
REPUTATION_MIN=300                         # [OPTIONAL] Minimum score (default: 300)
REPUTATION_MAX=850                         # [OPTIONAL] Maximum score (default: 850)
REPUTATION_DEFAULT=600                     # [OPTIONAL] Starting score (default: 600)
REPUTATION_AUTO_BAN_THRESHOLD=450          # [OPTIONAL] Auto-ban threshold (default: 450)

# =============================================================================
# COORDINATION SYSTEM (for horizontal scaling)
# Used by: trigger modules when running multiple instances
# =============================================================================
MAX_CLAIMS=5                               # [OPTIONAL] Max channels per container
HEARTBEAT_INTERVAL=300                     # [OPTIONAL] Heartbeat interval in seconds
CONTAINER_ID=                              # [OPTIONAL] Unique container identifier

# =============================================================================
# MODULE PORTS (for local development)
# =============================================================================
# Router
ROUTER_PORT=8000

# Trigger/Receiver Modules
DISCORD_MODULE_PORT=8001
TWITCH_MODULE_PORT=8002
SLACK_MODULE_PORT=8003

# Action/Interactive Modules
AI_MODULE_PORT=8005
SPOTIFY_MODULE_PORT=8006
YOUTUBE_MUSIC_MODULE_PORT=8007
SHOUTOUT_MODULE_PORT=8008
ALIAS_MODULE_PORT=8009
INVENTORY_MODULE_PORT=8010
MEMORIES_MODULE_PORT=8011
CALENDAR_MODULE_PORT=8012
LOYALTY_MODULE_PORT=8032

# Core Modules
IDENTITY_MODULE_PORT=8050
LABELS_MODULE_PORT=8051
BROWSER_SOURCE_MODULE_PORT=8052
REPUTATION_MODULE_PORT=8053
COMMUNITY_MODULE_PORT=8054

# Admin Modules
HUB_MODULE_PORT=8060

# ============================================================
# KONG API GATEWAY DATABASE CONFIGURATION
# ============================================================
# Kong uses a separate PostgreSQL database for isolation from WaddleBot data

# Kong Database Credentials
# NOTE: Must match password in config/postgres/init.sql for kong user
KONG_PG_PASSWORD=kong_db_pass_change_me
KONG_PG_USER=kong
KONG_PG_DATABASE=kong

# Kong Manager Session Secret (CHANGE in production!)
KONG_SESSION_SECRET=super-secret-session-key-change-in-production

# Kong Admin Credentials (for initial RBAC setup)
KONG_ADMIN_USERNAME=admin
KONG_ADMIN_PASSWORD=admin_password_change_me

# =============================================================================
# HUB MODULE - KONG MANAGEMENT (admin/hub_module)
# =============================================================================
KONG_ADMIN_URL=http://kong:8001             # [REQUIRED] Kong Admin API URL (internal Docker network)

# =============================================================================
# DOCKER-COMPOSE REQUIRED VARIABLES
# =============================================================================

# MinIO Object Storage
MINIO_ROOT_USER=waddlebot                         # [REQUIRED] MinIO root username
MINIO_ROOT_PASSWORD=waddlebot_minio_dev           # [REQUIRED] MinIO root password

# Node.js Environment
NODE_ENV=development                              # [REQUIRED] Node environment (development/production)
BASE_DOMAIN=localhost                             # [REQUIRED] Base domain for services

# Twitch Webhook
TWITCH_WEBHOOK_SECRET=dev_webhook_secret          # [REQUIRED] Secret for Twitch webhook verification

# Kick Platform
KICK_CLIENT_ID=                                   # [OPTIONAL] Kick client ID
KICK_CLIENT_SECRET=                               # [OPTIONAL] Kick client secret
KICK_WEBHOOK_SECRET=dev_kick_webhook_secret       # [OPTIONAL] Kick webhook secret

# YouTube
YOUTUBE_CLIENT_ID=                                # [OPTIONAL] YouTube OAuth client ID
YOUTUBE_CLIENT_SECRET=                            # [OPTIONAL] YouTube OAuth client secret
YOUTUBE_WEBHOOK_CALLBACK_URL=http://localhost:8006/webhook  # [OPTIONAL] YouTube webhook URL

# Ollama AI
OLLAMA_HOST=http://ollama                         # [REQUIRED] Ollama host URL
OLLAMA_PORT=11434                                 # [REQUIRED] Ollama port
OLLAMA_MODEL=tinyllama                             # [REQUIRED] Default Ollama model
OLLAMA_USE_TLS=false                              # [OPTIONAL] Use TLS for Ollama

# WaddleAI (optional external AI)
WADDLEAI_BASE_URL=                                # [OPTIONAL] WaddleAI API URL
WADDLEAI_API_KEY=                                 # [OPTIONAL] WaddleAI API key

# Mem0/Qdrant Vector Store
MEM0_VECTOR_STORE=qdrant                          # [REQUIRED] Vector store type
QDRANT_URL=http://qdrant:6333                     # [REQUIRED] Qdrant URL

# License Server
LICENSE_SERVER_URL=https://license.penguintech.io # [OPTIONAL] PenguinTech license server
RELEASE_MODE=false                                # [OPTIONAL] Enable license enforcement

# AWS Lambda (optional)
AWS_ACCESS_KEY_ID=                                # [OPTIONAL] AWS access key
AWS_SECRET_ACCESS_KEY=                            # [OPTIONAL] AWS secret key
AWS_REGION=us-east-1                              # [OPTIONAL] AWS region
AWS_LAMBDA_ROLE_ARN=                              # [OPTIONAL] Lambda execution role ARN

# GCP Functions (optional)
GCP_PROJECT_ID=                                   # [OPTIONAL] GCP project ID
GCP_REGION=us-central1                            # [OPTIONAL] GCP region
GCP_SERVICE_ACCOUNT_KEY=                          # [OPTIONAL] GCP service account key (JSON)
GCP_SERVICE_ACCOUNT_EMAIL=                        # [OPTIONAL] GCP service account email

# Module Secret Key (for inter-service auth)
MODULE_SECRET_KEY=dev_module_secret_change_me     # [REQUIRED] Shared secret for module auth

# =============================================================================
# READ REPLICA CONFIGURATION
# =============================================================================
DATABASE_REPLICA_URL=postgresql://waddlebot:waddlebot_password@postgres-replica:5432/waddlebot  # [OPTIONAL] Read replica URL
